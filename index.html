<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet"> 
        <title>Etch-a-sketch</title>
        <style>
            * {
                box-sizing: border-box; 
            }
            body {
                /*background-color: rgb(147, 247, 213);*/
                font-family: Pacifico, cursive;
                margin: 0;
            }
            div.main{
                position: relative;
                width: 100%;
                height: 100%;
            }

            div.header {
                position: absolute;
                top: 0;
                height: 20%;
                width: 100%;
                text-align: center;             
                background-image: linear-gradient(to bottom right, red, yellow, green, blue);                
            }

            h1 {                
                font-size: 50px;
            }

            .menu, .drawingBoard , .header{
                border: 5px black solid;
                border-radius: 10px;
            }
            div.menu{
               position: absolute;
               left: 0;
               bottom: 0;
               width: 50%;
               height: 80%;
            }      
            
            div.drawingBoard{
                position: absolute;
                right: 0;
                bottom: 0;
                width: 50%;
                height: 80%;
                display: grid;
            }  

            .tile {
                height: auto;
                width: auto;
                background-color: white;
                border: 1px solid rgb(238, 237, 237);
            }
        </style>
    </head>
    <body>        
        <main id="main" class="main">
            <div class="header">
                <h1>Etch-a-sketch</h1>
            </div>
            <div class="menu">
                <button type="button" id="clear">Clear Board</button>
                <button type="button" id="resize">Resize Board</button>
                <button type="button" id="rainbow">Use Magic Rainbow Pen</button>
                <button type="button" id="gray" style="display: none">10% Black</button>
            </div>
        </main>


        <script>
            //Initial setup
            let gridNumber = 16;  
            let color = "black";
            const field = document.getElementById("main");
            const drawingBoard = document.createElement("div");

            const clearBTN = document.getElementById("clear");
            const resizeBTN = document.getElementById("resize");
            const rainbowBTN = document.getElementById("rainbow");
            const grayBTN = document.getElementById("gray");

            drawBoard();
            drawTiles();

            //Buttons
            
            //Resize Button functionality
            resizeBTN.addEventListener("click", (e) => {
                gridNumber = prompt("How many rows do you want to see? Please enter a number.");
                resetTile();
                drawBoard();
                drawTiles();
                const blackCells = drawingBoard.querySelectorAll("div");                
                color = "black";
                blackCells.forEach((cell) => {
                    cell.addEventListener("mouseover", () => {
                    cell.style.backgroundColor = `${color}`;
                    });
                });                  
            });

            // Clear button functionality            
            clearBTN.addEventListener("click", (e) => {
                resetTile();                           
            });

            //Magic Rainbow Pen functionality
            rainbowBTN.addEventListener("click", (e) => {
                const rainbowCells = drawingBoard.querySelectorAll("div");  
                rainbowCells.forEach((cell) => {                           //This overrides the default event listener declared in the drawTiles function
                    cell.addEventListener("mouseover", () => { 
                    color = randomColor();
                    cell.style.backgroundColor = `${color}`;
                    });
                });  
            });

            // 10% Black button functionality
            grayBTN.addEventListener("click", (e) => {
                const grayCells = drawingBoard.querySelectorAll("div");                
                grayCells.forEach((cell) => {
                    cell.addEventListener("mouseover", () => { 
                    let opacity = 0.1;
                    cell.style.backgroundColor = `rgba(0, 0, 0, ${opacity}`;
                    opacity += 0.1;
                    });
                });                
            });
            //Functions
                //Create the drawing board function
                function drawBoard(){     
                    drawingBoard.classList.add("drawingBoard");
                    drawingBoard.style.gridTemplate = `repeat(${gridNumber}, 1fr) / repeat(${gridNumber}, 1fr)`;

                }

                //Create the tiles function
                function drawTiles(){
                    for(let i = 0; i <= gridNumber * gridNumber; i++){
                    const tile = document.createElement("div");
                    tile.classList.add("tile");                    
                    tile.addEventListener("mouseover", () => {  //Changing background-color on hovering
                    tile.style.backgroundColor = `${color}`;
                    });
                    drawingBoard.appendChild(tile);                
                    }
                    field.appendChild(drawingBoard);
                    }

                //Reset tiles function
                function resetTile(){
                    const tiles = drawingBoard.querySelectorAll("div");
                    tiles.forEach((div) => {
                    div.style.backgroundColor = "white";
                    });
                }

                //Create a random color function and call it for each tile
                function randomColor(){                      
                        let red = Math.floor(Math.random() * 255);
                        let green = Math.floor(Math.random() * 255);
                        let blue = Math.floor(Math.random() * 255);
                        return `rgb(${red}, ${green}, ${blue})`;
                }
        </script>
    </body>
</html>